# This file was autogenerated and will overwrite each time you run travis_pypi_setup.py
sudo: required
dist: xenial
language: python
group: edge

# source: https://github.com/Mousers/mousetrap-3.17/blob/c184167da0b6f03d75e9ba197ce80aa15bc72ad5/bin/ci-install-deps.bash
before_install:
  - PYTHON_VERSION=$(python -c "import sys; print('%s.%s' % sys.version_info[:2])")
  - PYTHON_INC_DIR=$(python -c "from distutils.sysconfig import get_python_inc; print(get_python_inc())")
  - PYTHON_SITE_PACKAGES=$(python -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())")
  - "sudo apt-get update -qq"
  - "sudo apt-get install -y gir1.2-gst-plugins-base-1.0 gir1.2-gstreamer-1.0 graphviz-dev gstreamer1.0-plugins-good gstreamer1.0-plugins-bad python-gst-1.0"
  - "sudo apt-get install -qq python3-gi"
  - "sudo apt-get install -qq python-gst-1.0 gstreamer1.0-plugins-base gstreamer1.0-plugins-bad gstreamer1.0-plugins-good gstreamer1.0-plugins-ugly gstreamer1.0-libav libsndfile1-dev libasound2-dev libgstreamer-plugins-base1.0-dev python-numpy python-scipy"
  # sudo apt-get --assume-yes install python3-gi \
  #   gstreamer1.0-tools \
  #   gir1.2-gstreamer-1.0 \
  #   gir1.2-gst-plugins-base-1.0 \
  #   gstreamer1.0-plugins-good \
  #   gstreamer1.0-plugins-ugly \
  #   gstreamer1.0-plugins-bad \
  #   gstreamer1.0-libav
  # - "sudo apt-get install -qq python3-xlib"
  - PYGI_LOCATION=$(dpkg-query -L python3-gi | grep "packages/gi$")
  - echo $PYTHON_VERSION
  - echo $PYTHON_INC_DIR
  - echo $PYTHON_SITE_PACKAGES
  - echo $PYGI_LOCATION
  - ln -s $PYGI_LOCATION "${PYTHON_SITE_PACKAGES}/gi"

deploy:
  distributions: sdist bdist_wheel
  provider: pypi
  user: bossjones
  password:
    secure: !!binary |
      UlR3T0FKekJlRVh5MWFzK2Ezc3V0Y1NqTlRmb1NnMTVlcDh0SElqT3FLMGV0a1RoV1hORnMwRnZX
      TnVDaFYzenNGaEE0MHNNcEFhbUh2Y0dYSjcxN0dBWUlQc3RJcmdBdXNMS003T0lVWHBVRjZrcXZa
      c1JRdzlSUFM0dkJtdWVCb0JvK3BMWTZxOWdJUCtCYXYrZkZ3V29jU3lqd0hMR2NhT1ZkT0YvbTJW
      YldFZzNwK1NHd1ZvbGd1U3BXQk5vYkxEbXdqOHlkL3FpWjZiMkx2VHJPVmtVRU5mYThaazhCU1hl
      clppVGU5OEkyYy9LdUdxa1ZpcmQrM0x1bEswa0RVMUZFTk85djVlaCt3WnpFbGdiVlNHZnk4N2dr
      ZGM1d2hZSXo0b0E3OTRHYzBqdCtZaVAyazBwTlBSR0FjckFuNU1SakNkdldRdG1rYnhkbnMvSlpP
      ZUs1OVNyaGNRNkJSZkROUUM5N01QRVpBei9FM3FoaURQeHdiaHVLK0xzZElpUkhuYXp3djRNdVVV
      MjdUY3F3dFRXY1lpanpUMGFpZmlRVVc2aEx3cG1WTXg2R0p5OGR2aGgrVXJzcjUyamFBYUZWeDMx
      TlVCOTYrV2EyMDRMQ1pWMUNGbzh2S2dxRHhUalpCZkVLMHplcFFVaDA2ZFJkTUphZUFOL2Roc3Vw
      TWpuRWZWWTVHU3YreVNLa0pKMnI3N21uZ3lWTzNzbk1zNngyc2RIK1BqZk1uT0VtUVVjcG5hTkNR
      RjAxUnh4ZlV6KzdUWTBKb25NNHliN2RuYytUNDAyRytQaEVES0dpNS9PMVlDSUh3V1FjTXhodjJy
      TWlZU2xVdDNpa2N4a1c4WUdoaFJ2RVVYMXJHeUF0UFdCYW55SitLTWIzUVd2N2h1S0U3RXpjL0U9
  true:
    condition: $TOXENV == py27
    repo: bossjones/scarlett_os
    tags: true
# env:
# - TOXENV=py35
# - TOXENV=pypy
# install: pip install -U tox
# language: python
# python: 3.5
# script: tox -e ${TOXENV}

# sudo: false
matrix:
  fast_finish: true
  include:
    - python: "3.5"
      env: TOXENV=typing
    - python: "3.5"
      env: TOXENV=py35
    - python: "pypy"
      env: TOXENV=pypy
  allow_failures:
    - python: "3.5"
      env: TOXENV=typing
cache:
  directories:
    - $HOME/.cache/pip
install: pip install -U tox coveralls
language: python
script: tox -e ${TOXENV}
after_success: coveralls
