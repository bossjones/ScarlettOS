#!/usr/bin/env bash
# Execute lint to spot code mistakes.

#  |2.4.3|  using virtualenv: system37   dev7behance1484 in ~/.pyenv/versions/system37/lib/python3.7/site-packages
# ○ → ls -lta /usr/local/lib/python3.7/site-packages/
# total 216
# drwxr-xr-x   8 malcolm  staff    256 Aug 16 21:32 virtualenv-16.0.0.dist-info
# drwxr-xr-x   7 malcolm  staff    224 Aug 16 21:32 virtualenv_support
# drwxr-xr-x  23 malcolm  staff    736 Aug 16 21:32 .
# drwxr-xr-x   5 malcolm  staff    160 Aug 16 21:32 __pycache__
# -rw-r--r--   1 malcolm  staff  99548 Aug 16 21:32 virtualenv.py
# drwxr-xr-x   5 malcolm  staff    160 Aug 16 20:27 pygtkcompat
# lrwxr-xr-x   1 malcolm  staff     95 Aug 16 20:27 pygobject-3.28.3-py3.7.egg-info -> ../../../Cellar/pygobject3/3.28.3_1/lib/python3.7/site-packages/pygobject-3.28.3-py3.7.egg-info
# drwxr-xr-x  18 malcolm  staff    576 Aug 16 20:27 gi
# drwxr-xr-x  11 malcolm  staff    352 Aug  1 10:50 pyside2uic
# drwxr-xr-x   8 malcolm  staff    256 Aug  1 10:50 PySide2-5.11.0-py3.7.egg-info
# drwxr-xr-x  55 malcolm  staff   1760 Aug  1 10:50 PySide2
# drwxr-xr-x   6 malcolm  staff    192 Aug  1 10:37 pycairo-1.17.1-py3.7.egg-info
# drwxr-xr-x   7 malcolm  staff    224 Aug  1 10:37 cairo
# drwxr-xr-x   9 malcolm  staff    288 Aug  1 08:41 wheel-0.31.1-py3.7.egg-info
# drwxr-xr-x  17 malcolm  staff    544 Aug  1 08:41 wheel
# drwxr-xr-x   8 malcolm  staff    256 Aug  1 08:41 pip-18.0-py3.7.egg-info
# drwxr-xr-x   7 malcolm  staff    224 Aug  1 08:41 pip
# drwxr-xr-x   9 malcolm  staff    288 Aug  1 08:41 setuptools-40.0.0-py3.7.egg-info
# drwxr-xr-x   7 malcolm  staff    224 Aug  1 08:41 pkg_resources
# drwxr-xr-x  42 malcolm  staff   1344 Aug  1 08:41 setuptools
# -rw-r--r--   1 malcolm  staff   1972 Aug  1 08:41 sitecustomize.py
# drwxr-xr-x   3 malcolm  staff     96 Aug  1 08:41 ..
# -rw-r--r--   1 malcolm  staff    126 Jun 27 02:06 easy_install.py

if [[ -z $PYTHON3 ]]; then
    PY3_MINOR_VER=`/usr/local/bin/python3 --version 2>&1 | cut -d " " -f 2 | cut -d "." -f 2`
    if (( $PY3_MINOR_VER < 5 )); then
    echo "Couldn't find python3 in \$PATH that is >=3.5"
    echo "Please install python3.5 or later or explicity define the python3 executable name with \$PYTHON3"
        echo "Exiting here"
        exit 1
    else
        export PYTHON3="python3.$PY3_MINOR_VER"
        export PYTHON3_VERSION=`/usr/local/bin/python3 --version 2>&1 | cut -d " " -f 2 | awk -F"." '{print $1"."$2}'`
        export _HOMEBREW_SITE_PACKAGES="/usr/local/lib/python${PYTHON3_VERSION}/site-packages/"
        export _HOMEBREW_PYENV_SITE_PACKAGES=`python -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())"`
        echo "\$PY3_MINOR_VER=$PY3_MINOR_VER"
        echo "\$PYTHON3=$PYTHON3"
        echo "\$PYTHON3_VERSION=$PYTHON3_VERSION"
        echo "\$_HOMEBREW_SITE_PACKAGES=$_HOMEBREW_SITE_PACKAGES"
    fi
fi

array=( 'pygtkcompat' 'pygobject*' 'gi' 'pycairo*' 'cairo' )
for i in "${array[@]}"
do
	# echo "ln -s ${_HOMEBREW_SITE_PACKAGES}${i} ${_HOMEBREW_PYENV_SITE_PACKAGES}/${i}"
    # ln -s ${_HOMEBREW_SITE_PACKAGES}${i} ${_HOMEBREW_PYENV_SITE_PACKAGES}/${i}
    echo "ls ${_HOMEBREW_SITE_PACKAGES}${i}"
    echo -e "\n"
    ls ${_HOMEBREW_SITE_PACKAGES}$i
    # ln -s ${_HOMEBREW_SITE_PACKAGES}$i ${_HOMEBREW_PYENV_SITE_PACKAGES}/$i
done

# ls -lta ${_HOMEBREW_SITE_PACKAGES}


# NOTE: This is what worked. AUTOMATE THIS AND WRITE A README FOR RUNNING SCARLETT BINDINGS AGAINST BLEEDING EDGE OSX/HOMEBREW
# virtualenv -p /usr/local/bin/python3 --system-site-packages ~/.pyenv/versions/system37
# pyenv activate system37
# pip install jupyter
# python -m ipykernel install --user
# pip install ptpython bpython
# cd `python -c "from distutils.sysconfig import get_python_lib; print(get_python_lib())"`
# ln -sf /usr/local/lib/python3.7/site-packages/pygtkcompat
# ln -sf /usr/local/lib/python3.7/site-packages/pygobject-3.28.3-py3.7.egg-info
# ln -sf /usr/local/lib/python3.7/site-packages/gi
# ln -sf /usr/local/lib/python3.7/site-packages/pycairo-1.17.1-py3.7.egg-info
# ln -sf /usr/local/lib/python3.7/site-packages/cairo

